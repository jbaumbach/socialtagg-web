extends layout

//- Include any page-specific javascript here
block javascripts

  script(type='text/javascript', src='/js/ng-events.js')

block content

  .container
    .sixteen.columns
      #page-title
        h2 My Owned Events
        #bolded-line  
  
  if !public.isLoggedIn
    .container
      .sixteen.columns
        .headline.no-margin
          h3 Events
  
          p Please 
            a(href=links.login) log in.
  else
    .controllerContainer.my-events(ng-controller='eventController')
      .container
      
        .twelve.columns
          //-.headline.no-margin.event-list
            h4 Events I Own
          
          //- Error message, set style explicitly so it won't flash on page refresh
          .notification.error(ng-show='hasError', style='display: none;')
            p
              span Sorry, there was an error! &nbsp; {{ errorMsg }}
              a.close(href='#', ng-click='hasError=false', no-click)
        
          table.standard-table(ng-show='hasEvents')
            thead
              tr
                th Name
                th Created
                th Actions
            tbody
              tr(data-id='{{event.uuid}}', ng-repeat='event in events')
                td
                 a(href='#', ng-click='editEvent(event)', no-click) {{ event.name }}
                td {{ event.created | date:'EEEE, M-d-yyyy, h:mm:ss a' }}
                td
                  a.button.gray(href='#', ng-click='editEvent(event)', no-click) Edit
                  a.button.gray(href='#', ng-click='deleteEvent(event)', no-click) Delete
                  a.button.color(href='{{ event.path }}', target='_blank') View
                  i.icon-spinner.icon-spin.icon-2x(ng-show='event.isWorking')
          p(ng-show='!hasEvents && isLoading') Loading events...
          
          p(ng-show='!hasEvents && !isLoading') You do not own any events at this time.
        
          a.button.color(href='#', ng-click='showEdit()', no-click) New Event
        
      .container(ng-show='isEditVisible')
        
        .six.columns
          //-
          //- Note: we're using Angular validation, so turn off HTML5 validation
          //- See: http://dailyjs.com/2013/06/06/angularjs-7/
          //-
          form.form-horizontal.new-event
            .headline 
              h4 Event Details
            
            input(type='hidden', ng-model='editableEvent.uuid')
        
            //- Note: the ng-model fields below must match the properties in the Event object
        
            .field
              label(for='inputName') Name of Event
              input.text(type='text', size='100', id='inputName', ng-model='editableEvent.name', required)
  
            .field
              label(for='inputDescription') Description
              input.text(type='text', size='100', id='inputDescription', ng-model='editableEvent.description', required)
  
            .field
              label(for='inputAddress') Address
              input.text(type='text', size='100', id='inputAddress', ng-model='editableEvent.address', required)
  
            .field
              label(for='inputDate') Date
              input.text(type='date', id='inputDate', ng-model='editableEvent.startDate', required)
  
            .field
              label(for='inputHours') Event Duration (hours)
              input.text(type='number', size='3', id='inputHours', ng-model='editableEvent.durationHours', required)
  
            .field
              label(for='inputWebsite') Website Url
              input.text(type='url', size='100', id='inputWebsite', ng-model='editableEvent.website')
  
  
            p
            a.button.color(href='#', ng-click='saveEvent(editableEvent)', no-click) Save
            a.button.gray(href='#', ng-click='cancelEdit()', no-click) Close
            i.icon-spinner.icon-spin.icon-2x(ng-show='isWorking')
  
        .six.columns
          .headline
            h4 Event Survey Questions
          
          div(ng-show='isCurrentEventSaved && (survey.inactive_ind || !survey)')
            //input(type='checkbox', ng-model='!survey.inactive_ind') 
            //span &nbsp; Include a post-event survey for attendees
            a.button.color(href='#', ng-click='showSurvey()', no-click) Add a Survey
          
          div(ng-show='!isCurrentEventSaved')
            p Save the current event to show survey options.
          
          .survey(ng-show='isCurrentEventSaved && !survey.inactive_ind && survey')
            
            ol.survey-questions(ng-show='survey.questions && survey.questions.length > 0')
              li(ng-repeat='question in survey.questions') 
                a(href='#', ng-click='editQuestion(question)', no-click) {{ question.text }}
                i.mini-ico-remove-sign(ng-click='removeQuestion(question)')
  
            p(ng-show='survey.questions && survey.questions.length == 0') Click 'Add Question' to add your survey questions.
            
            a.button.color(href='#', ng-click='addSurveyQuestion()', no-click) Add Question
            
            form.form-horizontal.new-survey-question(ng-show='editableQuestion')

              .headline
                h4 Survey Question Detail

              .field
                label(for='questionText') Question Text
                input.text(type='text', ng-model='editableQuestion.text', required)

              .field
                label(for='surveyQuestionType') Answer Type 
              
                .container
                  .three.columns
                    select(ng-model='editableQuestion.type', ng-options='q.value as q.label for q in questionTypes')
              
                  .three.columns
                    a.button.color(href='#', ng-click='saveQuestion(editableQuestion)', no-click) Save Question

              .multipleChoice(ng-show='showMultichoice()')
                .headline
                  h4 Multiple Choice Answers
  
                p
                
                ol.multi-choice-options
                  li(ng-repeat='choice in editableQuestion.choices') {{ choice }}
                    i.mini-ico-remove-sign(ng-click='removeMultichoicePossibleAnswer(choice)')
                
                p(ng-show='!editableQuestion.choices || editableQuestion.choices.length == 0')
                  | Enter the possible choices for this question below.  Click the plus sign after each one.

                .field.answer-type
                  label(for='multichoicePossibleAnswer') Multiple Choice Possible Answer
                  
                  .container
                    .five.columns
                      input.text(type='text', ng-model='multichoicePossibleAnswer', id='multichoicePossibleAnswer', required)
                    .one.column
                      i.ico-circle-plus(ng-click='saveMultichoicePossibleAnswer()')
  
            p
            a.button.color(href='#', ng-click='saveSurvey()', no-click) Save Survey
            a.button.gray(href='#', ng-click='removeSurvey()', no-click) Remove Survey
  
  
  
  





